Index: munin-1.2.6/node/node.d/snmp__if_.in
===================================================================
--- munin-1.2.6.orig/node/node.d/snmp__if_.in	2008-10-15 23:59:12.000000000 +0200
+++ munin-1.2.6/node/node.d/snmp__if_.in	2008-10-16 00:01:09.000000000 +0200
@@ -91,15 +91,23 @@
 my $port      = $ENV{port}      || 161;
 my $community = $ENV{community} || "public";
 my $iface     = $ENV{interface} || undef;
+my $rfc2233   = $ENV{rfc2233}   || undef;
 
 my $response;
 
 if (defined $ARGV[0] and $ARGV[0] eq "snmpconf")
 {
-	print "number  1.3.6.1.2.1.2.1.0\n";
-	print "index   1.3.6.1.2.1.2.2.1.1.\n";
-	print "require 1.3.6.1.2.1.2.2.1.3. ^(6|23)\$\n"; # Type
-	print "require 1.3.6.1.2.1.2.2.1.5. [1-9]\n"; # Speed
+	if (!defined($rfc2233)) {
+	    print "number  1.3.6.1.2.1.2.1.0\n";              # number of interfaces
+	    print "index   1.3.6.1.2.1.2.2.1.1.\n";           # ifTable -> ifEntry
+	    print "require 1.3.6.1.2.1.2.2.1.3. ^(6|23)\$\n"; # Type
+	    print "require 1.3.6.1.2.1.2.2.1.5. [1-9]\n";     # Speed
+	} else {
+	    print "number  1.3.6.1.2.1.2.1.0\n";              # number of interfaces
+	    print "index   1.3.6.1.2.1.31.1.1.1.\n";          # ifXTable -> ifXEntry 
+	    print "require 1.3.6.1.2.1.2.2.1.3. ^(6|23)\$\n"; # Type
+	    print "require 1.3.6.1.2.1.31.1.1.1.15. [1-9]\n"; # ifHighSpeed
+	}
 	exit 0;
 }
 
@@ -119,11 +127,24 @@
 	die "# Error: couldn't understand what I'm supposed to monitor.";
 }
 
-my $ifEntryDescr     = "1.3.6.1.2.1.2.2.1.2.$iface"; 
-my $ifEntrySpeed     = "1.3.6.1.2.1.2.2.1.5.$iface";
-my $ifEntryStatus    = "1.3.6.1.2.1.2.2.1.8.$iface";
-my $ifEntryInOctets  = "1.3.6.1.2.1.2.2.1.10.$iface";
-my $ifEntryOutOctets = "1.3.6.1.2.1.2.2.1.16.$iface";
+if (!defined($rfc2233)) {
+
+	my $ifEntryDescr     = "1.3.6.1.2.1.2.2.1.2.$iface"; 
+	my $ifEntrySpeed     = "1.3.6.1.2.1.2.2.1.5.$iface";
+	my $ifEntryStatus    = "1.3.6.1.2.1.2.2.1.8.$iface";
+	my $ifEntryInOctets  = "1.3.6.1.2.1.2.2.1.10.$iface";
+	my $ifEntryOutOctets = "1.3.6.1.2.1.2.2.1.16.$iface";
+
+} else {
+
+	my $ifEntryDescr     = "1.3.6.1.2.1.2.2.1.2.$iface"; 
+	my $ifEntrySpeed     = "1.3.6.1.2.1.31.1.1.1.15.$iface";
+	my $ifEntryStatus    = "1.3.6.1.2.1.2.2.1.8.$iface";
+	my $ifEntryInOctets  = "1.3.6.1.2.1.31.1.1.1.6.$iface";
+	my $ifEntryOutOctets = "1.3.6.1.2.1.31.1.1.1.10.$iface";
+
+}
+
 
 my ($session, $error) = Net::SNMP->session(
 		-hostname  => $host,
